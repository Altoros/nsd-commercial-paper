# #########################################################################
# This script updates project source code then upgrades chaincodes
###########################################################################
#!/usr/bin/env bash

cc_version=$1

[ -z "$cc_version" ] && echo "Specify new chaincode version in the first argument, e.g: 2.0" && exit 1

echo "Upgrade to version: $cc_version"

# #########################################################################
# Update source codes
###########################################################################
./git-update.sh

# #########################################################################
# Install chaincode
###########################################################################
./install-cc.sh $cc_version

# #########################################################################
# Upgrade
###########################################################################
if [ "$THIS_ORG" == "$MAIN_ORG" ]; then
  ./upgrade-cc.sh $cc_version
fi